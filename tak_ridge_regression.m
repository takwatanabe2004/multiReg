function w=tak_ridge_regression(X,y,lam)
% w=tak_ridge_regression(X,y,lam)
%=========================================================================%
% (X'X + lam*I)^-1 X'y
%=========================================================================%
% (06/14/2014)
%%
if nargin == 2
    % default penalty value
    lam = 1;
end
[n,p]=size(X);
Xty = X'*y;

if n > p
    %=====================================================================%
    % solve directly:  w = (X'X + lam*I)^-1 X'y
    %=====================================================================%
    w=(X'*X + lam*eye(p))\Xty;
else
    %=====================================================================%
    % inversion lemma: K = X'*(I + X*X')^-1
    %                  w = X'y/lam - 1/lam^2 (K*X*X'*y)
    %=====================================================================%
    TMP= eye(n) + (X*X')/lam;
    K = (TMP\X)';
    w = Xty/lam - 1/lam^2*K*(X*Xty);
end

